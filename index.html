<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mistry4Ever Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* style.css content starts here */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #120a20; /* Latar belakang ungu gelap yang lebih kaya */
            color: #e0e0e0; /* Teks abu-abu terang */
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }
        .container {
            background-color: #1f1430; /* Ungu sedikit lebih terang untuk kontainer */
            border-radius: 1.5rem; /* Sudut lebih membulat */
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5); /* Bayangan lebih kuat */
            width: 100%;
            max-width: 420px; /* Lebar maksimum seperti tampilan mobile */
            margin: 1.5rem; /* Margin lebih besar */
            overflow: hidden;
            min-height: 80vh; /* Sesuaikan atau hapus jika konten sangat panjang */
            display: flex;
            flex-direction: column;
        }
        .header {
            background-color: #2b1d40; /* Ungu lebih gelap untuk header */
            padding: 1rem 1.5rem; /* Padding lebih besar */
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #3c2a50; /* Garis bawah lebih gelap */
            position: sticky; /* Agar header tetap di atas saat scroll */
            top: 0;
            z-index: 100;
        }
        .header-title-group { /* New container for title and slogan */
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .header-title {
            font-size: 1.35rem; /* Sedikit lebih besar */
            font-weight: 700; /* Lebih tebal */
            color: #ffffff;
        }
        .header-slogan { /* New style for the slogan */
            font-size: 0.8rem;
            font-weight: 500;
            color: #a0a0a0; /* Lighter grey for slogan */
            margin-top: 0.2rem;
        }
        .section-title {
            font-size: 1.15rem; /* Sedikit lebih besar */
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.75rem;
        }
        .input-group {
            display: flex;
            flex-direction: column; /* Ubah menjadi kolom untuk menumpuk input */
            gap: 0.75rem; /* Jarak lebih besar */
            margin-bottom: 1rem;
        }
        .input-item-row { /* Tambahkan div untuk setiap baris input */
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }
        .input-group input {
            flex-grow: 1;
            background-color: #3a2a50; /* Latar belakang input lebih gelap */
            border: 1px solid #4a3a60; /* Border input lebih gelap */
            border-radius: 0.75rem; /* Lebih membulat */
            padding: 0.85rem; /* Padding lebih besar */
            color: #e0e0e0;
            font-size: 0.95rem;
            outline: none; /* Hapus outline saat fokus */
        }
        .input-group input:focus {
            border-color: #a050ff; /* Sorot saat fokus */
            box-shadow: 0 0 0 2px rgba(160, 80, 255, 0.4);
        }
        .input-group input::placeholder {
            color: #a0a0a0;
        }
        .input-group .info-icon { /* Gaya ikon info dikembalikan */
            background-color: #5a4a70; /* Ikon info lebih gelap */
            border-radius: 50%;
            width: 24px; /* Lebih besar */
            height: 24px; /* Lebih besar */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.85rem; /* Font lebih besar */
            font-weight: 700;
            color: #ffffff;
            cursor: pointer;
            flex-shrink: 0; /* Cegah menyusut */
        }
        .tab-buttons {
            display: flex;
            background-color: #2b1d40; /* Latar belakang tab lebih gelap */
            border-radius: 1rem; /* Lebih membulat */
            overflow: hidden;
            margin-bottom: 1.25rem; /* Margin lebih besar */
            padding: 0.25rem; /* Padding untuk tombol di dalam */
            flex-wrap: wrap; /* Izinkan tab untuk pindah baris di layar kecil */
        }
        .tab-button {
            flex: 1;
            min-width: 24%; /* Pastikan minimal 4 item per baris, sesuaikan jika perlu */
            padding: 0.85rem 0.5rem; /* Padding disesuaikan agar pas */
            text-align: center;
            font-size: 0.85rem; /* Font sedikit lebih kecil agar pas */
            font-weight: 500;
            color: #a0a0a0;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border-radius: 0.75rem; /* Sudut membulat untuk tombol individual */
            margin: 0.125rem; /* Margin kecil antar tombol untuk pemisah */
        }
        .tab-button.active {
            background-color: #a050ff; /* Ungu terang untuk tab aktif */
            color: #ffffff;
            box-shadow: 0 2px 8px rgba(160, 80, 255, 0.4); /* Bayangan lebih kuat */
            font-weight: 600;
        }
        .diamond-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); /* Item sedikit lebih besar */
            gap: 1rem; /* Jarak lebih besar */
            margin-bottom: 1.5rem;
        }
        .diamond-item {
            background-color: #2b1d40; /* Latar belakang item lebih gelap */
            border-radius: 1rem; /* Lebih membulat */
            padding: 1.25rem; /* Padding lebih besar */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 3px solid transparent; /* Border lebih tebal */
            position: relative;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .diamond-item.selected {
            border-color: #a050ff;
            box-shadow: 0 0 20px rgba(160, 80, 255, 0.8);
        }
        .diamond-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }
        .diamond-item .hot-tag, .diamond-item .popular-tag {
            position: absolute;
            top: 0.6rem;
            left: 0.6rem;
            background-color: #ff3366; /* Merah cerah untuk HOT */
            color: white;
            padding: 0.3rem 0.8rem; /* Padding lebih besar */
            border-radius: 0.75rem; /* Lebih membulat */
            font-size: 0.75rem; /* Font sedikit lebih besar */
            font-weight: 700; /* Lebih tebal */
            text-transform: uppercase;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        .diamond-item .popular-tag {
            background-color: #ff66cc; /* Pink cerah untuk POPULAR */
        }
        .icon-emoji { /* Gaya baru untuk semua ikon emoji */
            font-size: 48px; /* Emoji lebih besar */
            line-height: 1;
            margin-bottom: 0.75rem;
            width: 70px; /* Sesuaikan lebar gambar sebelumnya */
            height: 70px; /* Sesuaikan tinggi gambar sebelumnya */
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #3a2a50; /* Latar belakang untuk ikon emoji */
            border-radius: 0.75rem; /* Sudut membulat untuk wadah ikon emoji */
        }
        .game-icon-emoji { /* Gaya khusus untuk emoji pemilihan game */
            font-size: 72px; /* Lebih besar lagi untuk pemilihan game */
            line-height: 1;
            margin-bottom: 1.25rem;
            width: 120px; /* Sesuaikan lebar gambar sebelumnya */
            height: 120px; /* Sesuaikan tinggi gambar sebelumnya */
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #3a2a50; /* Latar belakang untuk ikon emoji */
            border-radius: 1rem; /* Sudut membulat untuk wadah ikon emoji */
        }
        .diamond-item .diamond-count {
            font-size: 1.2rem; /* Font lebih besar */
            font-weight: 700; /* Lebih tebal */
            color: #ffffff;
            margin-bottom: 0.25rem;
        }
        .diamond-item .price-display { /* Tampilan harga terkonsolidasi */
            font-size: 1.35rem; /* Font lebih besar */
            font-weight: 800; /* Ekstra tebal */
            color: #a050ff; /* Ungu terang untuk harga */
            margin-top: 0.25rem;
        }
        .info-card {
            background-color: #2b1d40;
            border-radius: 1rem;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            border: 1px solid #3c2a50;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .info-card h4 {
            font-size: 1.05rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 0.6rem;
        }
        .info-card p {
            font-size: 0.9rem;
            color: #c0c0c0;
            line-height: 1.5;
        }
        .info-card .learn-more {
            color: #a050ff;
            font-weight: 600;
            cursor: pointer;
            margin-top: 0.75rem;
            display: inline-block;
            transition: color 0.2s ease-in-out;
        }
        .info-card .learn-more:hover {
            color: #c080ff;
        }
        .payment-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem; /* Jarak lebih besar */
            margin-top: 1rem;
            margin-bottom: 1.5rem;
        }
        .payment-item {
            background-color: #2b1d40;
            border-radius: 1rem; /* Lebih membulat */
            padding: 1.25rem; /* Padding lebih besar */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 3px solid transparent; /* Border lebih tebal */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative; /* Untuk overlay dinonaktifkan */
        }
        .payment-item.selected {
            border-color: #a050ff;
            box-shadow: 0 0 20px rgba(160, 80, 255, 0.8);
        }
        .payment-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }
        .payment-item img {
            max-width: 90px; /* Logo lebih besar */
            height: auto;
            margin-bottom: 0.75rem;
        }
        .payment-item .payment-name {
            font-size: 1rem; /* Sedikit lebih besar */
            font-weight: 600;
            color: #ffffff;
        }
        /* Gaya untuk metode pembayaran yang dinonaktifkan */
        .payment-item.disabled-payment {
            opacity: 0.5; /* Abu-abu */
            cursor: not-allowed;
            pointer-events: none; /* Nonaktifkan event klik */
            background-color: #1a102a; /* Latar belakang lebih gelap untuk yang dinonaktifkan */
            border-color: #3c2a50; /* Sesuaikan border dengan tampilan dinonaktifkan */
        }
        .payment-item.disabled-payment .maintenance-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6); /* Overlay gelap */
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffcc00; /* Warna peringatan */
            font-weight: 700;
            text-align: center;
            padding: 0.5rem;
            border-radius: 1rem; /* Sesuaikan radius border induk */
            font-size: 0.85rem;
        }
        /* Gaya untuk item 2x Recharge yang sudah dibeli */
        .diamond-item.purchased-item {
            opacity: 0.6;
            cursor: not-allowed;
            pointer-events: none;
            background-color: #1a102a;
            border-color: #3c2a50;
            position: relative;
        }
        .diamond-item.purchased-item .purchased-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4CAF50; /* Warna hijau untuk "Sudah Dibeli" */
            font-weight: 700;
            text-align: center;
            padding: 0.5rem;
            border-radius: 1rem;
            font-size: 1.1rem;
            z-index: 1; /* Pastikan di atas konten lain */
        }
        .topup-first-text {
            font-size: 0.75rem;
            color: #a0a0a0;
            margin-top: 0.25rem;
            display: block;
        }
        /* Gaya overlay loading */
        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1f1430, #0a0510); /* Gradient background */
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 1.5rem; /* Increased gap */
            z-index: 2000;
            color: white;
            font-size: 1.6rem; /* Slightly larger font */
            text-shadow: 0 2px 5px rgba(0,0,0,0.5); /* Text shadow for depth */
        }
        #loadingOverlay p {
            text-align: center;
            margin: 0;
            line-height: 1.4; /* Spasi baris lebih baik */
        }
        .spinner {
            border: 6px solid rgba(255, 255, 255, 0.2); /* Border lebih tebal, lebih transparan */
            border-top: 6px solid #a050ff; /* Ungu terang yang cerah */
            border-radius: 50%;
            width: 60px; /* Spinner lebih besar */
            height: 60px; /* Spinner lebih besar */
            animation: spin 1s linear infinite, pulse 1.5s infinite alternate; /* Animasi putar dan denyut */
            box-shadow: 0 0 20px rgba(160, 80, 255, 0.7); /* Efek cahaya */
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.05); opacity: 0.9; }
        }

        /* Konten game disembunyikan secara default */
        .content-section, .admin-screen {
            display: none;
            flex-direction: column;
            flex-grow: 1;
            height: calc(100% - 64px); /* Tinggi header sekitar 64px */
        }
        .content-section.active, .admin-screen.active {
            display: flex;
        }
        .game-selection {
            display: flex; /* Tampilkan secara default */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            padding: 2rem; /* Tambahkan padding untuk layar pemilihan game */
        }
        .game-selection.active {
            display: flex;
        }
        .game-card {
            background-color: #2b1d40;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 3px solid transparent;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            width: 80%; /* Sesuaikan lebar kartu game */
            max-width: 250px; /* Batasi lebar maksimum */
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            border-color: #a050ff;
        }
        .game-card h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #ffffff;
            margin-top: 0.5rem;
        }

        /* Perbaiki masalah scroll untuk konten utama */
        .main-content-padding {
            flex-grow: 1; /* Memungkinkan konten mengambil ruang yang tersedia */
            overflow-y: auto; /* Memungkinkan pengguliran vertikal untuk bagian ini */
            padding: 1.5rem; /* Padding asli */
            padding-bottom: 2rem; /* Padding dikurangi karena tombol sekarang ada di dalam */
        }

        /* Gaya bilah bawah tetap - sekarang bertindak sebagai blok biasa di dalam konten */
        .fixed-bottom-bar {
            width: 100%;
            background-color: transparent; /* Tidak perlu latar belakang jika di dalam konten */
            padding: 1rem 0; /* Sesuaikan padding */
            box-shadow: none; /* Tidak perlu bayangan */
            z-index: auto;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 1.5rem; /* Tambahkan sedikit ruang di atas tombol */
            position: relative; /* Hapus posisi sticky */
            bottom: auto; /* Hapus posisi sticky */
        }
        .confirm-button {
            background-color: #a050ff; /* Ungu terang yang cerah */
            color: white;
            font-weight: 700;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            width: 100%;
            max-width: 300px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            border: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .confirm-button:hover {
            background-color: #c080ff; /* Ungu lebih terang saat hover */
            transform: translateY(-2px);
        }
        .confirm-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        /* Gaya Modal Peringatan Kustom */
        .order-summary-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }

        .order-summary-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .order-summary-content {
            background-color: #1f1430;
            border-radius: 1.5rem;
            padding: 2rem;
            width: 90%;
            max-width: 350px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
            text-align: center;
            position: relative;
        }

        .order-summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .order-summary-header h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #ffffff;
        }

        .order-summary-content .close-btn {
            background: none;
            border: none;
            color: #a0a0a0;
            font-size: 1.5rem;
            cursor: pointer;
            position: absolute;
            top: 1rem;
            right: 1rem;
        }

        /* CSS untuk animasi silang */
        .cross-animation {
            font-size: 3rem;
            color: #ff4d4d; /* Warna merah untuk silang */
            animation: popIn 0.5s ease-out forwards;
            margin-top: 1rem;
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Tampilan Nama Pemain */
        .player-name-display {
            font-size: 0.9rem;
            font-weight: 600;
            margin-top: 0.5rem;
            text-align: center;
            color: #4CAF50; /* Warna hijau untuk nama yang dikonfirmasi */
            display: none; /* Tersembunyi secara default */
        }

        /* Gaya Khusus Admin */
        .admin-login-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 2rem;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
        }
        .admin-login-form input {
            width: 100%;
            max-width: 250px;
            background-color: #3a2a50;
            border: 1px solid #4a3a60;
            border-radius: 0.75rem;
            padding: 0.85rem;
            color: #e0e0e0;
            font-size: 0.95rem;
            outline: none;
            text-align: center;
        }
        .admin-login-form button {
            width: 100%;
            max-width: 250px;
            background-color: #a050ff;
            color: white;
            font-weight: 700;
            padding: 0.85rem;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .admin-login-form button:hover {
            background-color: #c080ff;
        }

        .admin-dashboard-content {
            padding: 1.5rem;
            overflow-y: auto;
            flex-grow: 1;
        }

        .admin-request-item {
            background-color: #2b1d40;
            border-radius: 1rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .admin-request-item p {
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: #c0c0c0;
        }
        .admin-request-item strong {
            color: #ffffff;
        }
        .admin-request-item .actions {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }
        .admin-request-item .actions button {
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            border: none;
            color: white;
        }
        .admin-request-item .actions .register-btn {
            background-color: #4CAF50; /* Hijau */
        }
        .admin-request-item .actions .register-btn:hover {
            background-color: #6BC070;
        }
        .admin-request-item .actions .unregister-btn {
            background-color: #ff4d4d; /* Merah */
        }
        .admin-request-item .actions .unregister-btn:hover {
            background-color: #ff6a6a;
        }
        .admin-request-item .player-name-input-group {
            display: flex;
            flex-direction: column; /* Diubah menjadi kolom untuk penumpukan yang lebih baik di seluler */
            gap: 0.5rem;
            margin-top: 0.75rem;
            align-items: stretch; /* Regangkan item untuk mengisi lebar */
        }
        .admin-request-item .player-name-input-group input {
            flex-grow: 1;
            background-color: #3a2a50;
            border: 1px solid #4a3a60;
            border-radius: 0.5rem;
            padding: 0.6rem;
            color: #e0e0e0;
            font-size: 0.9rem;
            outline: none;
            width: 100%; /* Pastikan input mengambil lebar penuh */
        }
        .admin-request-item .player-name-input-group button {
            padding: 0.6rem 1rem;
            background-color: #a050ff;
            border-radius: 0.5rem;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            border: none;
            width: 100%; /* Pastikan tombol mengambil lebar penuh */
        }
        .admin-request-item .player-name-input-group button:hover {
            background-color: #c080ff;
        }

        /* Tombol Salin di Dashboard Admin */
        .copy-btn {
            background: none;
            border: none;
            color: #a0a0a0; /* Abu-abu terang untuk ikon salin */
            font-size: 0.9em; /* Ikon lebih kecil */
            cursor: pointer;
            margin-left: 0.5em;
            transition: color 0.2s ease-in-out;
            padding: 0; /* Hapus padding */
            line-height: 1; /* Sejajarkan secara vertikal */
            display: inline-flex; /* Untuk penyelarasan yang lebih baik */
            align-items: center;
            justify-content: center;
            width: 1.5em; /* Lebar tetap untuk tampilan yang konsisten */
            height: 1.5em; /* Tinggi tetap */
            border-radius: 0.25em; /* Sudut sedikit membulat */
        }
        .copy-btn:hover {
            color: #ffffff; /* Putih saat hover */
            background-color: #5a4a70; /* Latar belakang halus saat hover */
        }
        .copy-feedback {
            font-size: 0.75em;
            color: #4CAF50; /* Hijau untuk "Disalin!" */
            margin-left: 0.5em;
            opacity: 0;
            transition: opacity 0.3s ease-out;
        }
        .copy-feedback.show {
            opacity: 1;
        }

        /* Lencana Notifikasi */
        .notification-badge {
            background-color: #ff4d4d; /* Merah */
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            border-radius: 50%;
            padding: 0.2rem 0.5rem;
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            transform: translate(50%, -50%);
            display: none; /* Tersembunyi secara default */
        }
        .notification-icon-wrapper {
            position: relative;
            cursor: pointer;
            margin-left: 1rem; /* Jarak dari ikon pencarian */
        }

        /* Pop-up Notifikasi Admin */
        #adminNotificationPopup {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50; /* Latar belakang hijau */
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            font-size: 1rem;
            font-weight: 600;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        #adminNotificationPopup.show {
            opacity: 1;
            visibility: visible;
        }
        /* style.css content ends here */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-7 h-7 text-white cursor-pointer hidden" id="backButton">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                </svg>
                <div class="header-title-group">
                    <span class="header-title">Mistry4Ever Store</span>
                    <span class="header-slogan">Topup Murah dan Terpercaya</span>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6 text-white">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                </svg>
                <div class="notification-icon-wrapper" id="adminIconWrapper">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6 text-white cursor-pointer" id="adminLoginBtn">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span class="notification-badge" id="notificationBadge">0</span>
                </div>
            </div>
        </div>

        <div id="gameSelectionScreen" class="game-selection active">
            <h2 class="text-2xl font-bold text-white mb-8">Pilih Game</h2>
            <div class="game-card" data-game="mlbb">
                <div class="game-icon-emoji">🎮</div>
                <h3>Mobile Legends: Bang Bang</h3>
            </div>
            <div class="game-card" data-game="ff">
                <div class="game-icon-emoji">🎮</div>
                <h3>Free Fire</h3>
            </div>
        </div>

        <div id="mlbbContent" class="content-section">
            <div class="main-content-padding">
                <div class="flex items-center gap-4 mb-5">
                    <div class="icon-emoji w-16 h-16 rounded-lg">🎮</div>
                    <div>
                        <h2 class="text-xl font-bold text-white">Mobile Legends: Bang Bang</h2>
                        <div class="flex items-center text-sm text-gray-400 mt-1">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 mr-1">
                                <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
                            </svg>
                            Pembayaran yang Aman
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">1</span>
                        <span class="section-title">Masukkan User ID</span>
                    </div>
                    <div class="input-group">
                        <div class="input-item-row">
                            <input type="text" id="mlbbUserID" placeholder="Masukkan User ID" pattern="[0-9]*" inputmode="numeric" onpaste="return true;">
                            <div class="info-icon" data-info="Untuk mengetahui User ID Anda, silakan klik menu profile dibagian kiri atas pada menu utama game. User ID akan terlihat dibagian bawah Nama Karakter Game Anda. Silakan masukkan User ID Anda untuk menyelesaikan transaksi. Contoh : 12345678(1234).">?</div>
                        </div>
                        <div class="input-item-row">
                            <input type="text" id="mlbbZoneID" placeholder="Zone ID" class="zone-id" pattern="[0-9]*" inputmode="numeric" onpaste="return true;">
                            <div class="info-icon" data-info="Zone ID adalah angka di dalam tanda kurung setelah User ID Anda. Contoh: 12345678(1234), Zone ID Anda adalah 1234.">?</div>
                        </div>
                        <div id="mlbbPlayerNameDisplay" class="player-name-display hidden"></div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">2</span>
                        <span class="section-title">Pilih Nominal Top Up</span>
                    </div>
                    <div class="flex items-center text-sm text-red-400 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 mr-1">
                            <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
                        </svg>
                        27.076 item dibeli dalam satu jam terakhir
                    </div>

                    <div class="tab-buttons mb-4">
                        <div class="tab-button active" data-tab="diamond">Diamond</div>
                        <div class="tab-button" data-tab="2x-recharge">2x Recharge Bonus</div>
                        <div class="tab-button" data-tab="twilight-pass">Twilight Pass</div>
                        <div class="tab-button" data-tab="weekly-pass">Weekly Diamond Pass</div>
                    </div>

                    <div id="diamond-content" class="tab-content">
                        <div class="diamond-grid">
                            <div class="diamond-item" data-price="4080" data-diamonds="3">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">3 Diamonds</div>
                                <div class="price-display">Rp. 4.080</div>
                            </div>
                            <div class="diamond-item popular-item" data-price="4093" data-diamonds="5">
                                <span class="popular-tag">POPULAR</span>
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">5 Diamonds</div>
                                <div class="price-display">Rp. 4.093</div>
                            </div>
                            <div class="diamond-item" data-price="6189" data-diamonds="12">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">12 Diamonds</div>
                                <div class="price-display">Rp. 6.189</div>
                            </div>
                            <div class="diamond-item" data-price="8298" data-diamonds="19">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">19 Diamonds</div>
                                <div class="price-display">Rp. 8.298</div>
                            </div>
                            <div class="diamond-item" data-price="10936" data-diamonds="28">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">28 Diamonds</div>
                                <div class="price-display">Rp. 10.936</div>
                            </div>
                            <div class="diamond-item" data-price="15154" data-diamonds="44">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">44 Diamonds</div>
                                <div class="price-display">Rp. 15.154</div>
                            </div>
                            <div class="diamond-item" data-price="19372" data-diamonds="59">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">59 Diamonds</div>
                                <div class="price-display">Rp. 19.372</div>
                            </div>
                            <div class="diamond-item" data-price="26754" data-diamonds="85">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">85 Diamonds</div>
                                <div class="price-display">Rp. 26.754</div>
                            </div>
                            <div class="diamond-item" data-price="51007" data-diamonds="170">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">170 Diamonds</div>
                                <div class="price-display">Rp. 51.007</div>
                            </div>
                            <div class="diamond-item" data-price="71043" data-diamonds="240">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">240 Diamonds</div>
                                <div class="price-display">Rp. 71.043</div>
                            </div>
                            <div class="diamond-item popular-item" data-price="86860" data-diamonds="296">
                                <span class="popular-tag">POPULAR</span>
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">296 Diamonds</div>
                                <div class="price-display">Rp. 86.860</div>
                            </div>
                            <div class="diamond-item" data-price="118500" data-diamonds="408">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">408 Diamonds</div>
                                <div class="price-display">Rp. 118.500</div>
                            </div>
                            <div class="diamond-item" data-price="160675" data-diamonds="568">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">568 Diamonds</div>
                                <div class="price-display">Rp. 160.675</div>
                            </div>
                            <div class="diamond-item" data-price="245035" data-diamonds="875">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">875 Diamonds</div>
                                <div class="price-display">Rp. 245.035</div>
                            </div>
                            <div class="diamond-item" data-price="529750" data-diamonds="2010">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">2010 Diamonds</div>
                                <div class="price-display">Rp. 529.750</div>
                            </div>
                            <div class="diamond-item" data-price="1267900" data-diamonds="4830">
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">4830 Diamonds</div>
                                <div class="price-display">Rp. 1.267.900</div>
                            </div>
                        </div>
                    </div>

                    <div id="2x-recharge-content" class="tab-content hidden">
                        <div class="info-card mb-4">
                            <h4>2x Recharge Bonus</h4>
                            <p>Selama event ini, player yang belum top up tingkatan 50/150/250/500 Diamond melalui platform ini bisa menikmati bonus Diamond tambahan.</p>
                            <span class="learn-more">Learn more</span>
                        </div>
                        <div class="diamond-grid">
                            <div class="diamond-item hot-item" data-price="18265" data-diamonds="100" data-bonus-type="2x_recharge_100">
                                <span class="hot-tag">HOT</span>
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">100 Diamonds (50+50)</div>
                                <div class="price-display">Rp. 18.265</div>
                                <span class="topup-first-text">Topup Pertama!</span>
                                <div class="purchased-overlay hidden">Sudah Dibeli</div>
                            </div>
                            <div class="diamond-item hot-item" data-price="49495" data-diamonds="300" data-bonus-type="2x_recharge_300">
                                <span class="hot-tag">HOT</span>
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">300 Diamonds (150+150)</div>
                                <div class="price-display">Rp. 49.495</div>
                                <span class="topup-first-text">Topup Pertama!</span>
                                <div class="purchased-overlay hidden">Sudah Dibeli</div>
                            </div>
                            <div class="diamond-item hot-item" data-price="80892" data-diamonds="500" data-bonus-type="2x_recharge_500">
                                <span class="hot-tag">HOT</span>
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">500 Diamonds (250+250)</div>
                                <div class="price-display">Rp. 80.892</div>
                                <span class="topup-first-text">Topup Pertama!</span>
                                <div class="purchased-overlay hidden">Sudah Dibeli</div>
                            </div>
                            <div class="diamond-item hot-item" data-price="160148" data-diamonds="1000" data-bonus-type="2x_recharge_1000">
                                <span class="hot-tag">HOT</span>
                                <div class="icon-emoji">💎</div>
                                <div class="diamond-count">1000 Diamonds (500+500)</div>
                                <div class="price-display">Rp. 160.148</div>
                                <span class="topup-first-text">Topup Pertama!</span>
                                <div class="purchased-overlay hidden">Sudah Dibeli</div>
                            </div>
                        </div>
                    </div>

                    <div id="twilight-pass-content" class="tab-content hidden">
                        <div class="info-card mb-4">
                            <h4>Twilight Pass</h4>
                            <p>Mobile Legends Twilight Pass hanya bisa dibeli sekali per-user account.</p>
                        </div>
                        <div class="diamond-grid">
                            <div class="diamond-item" data-price="169000" data-diamonds="Twilight Pass">
                                <div class="icon-emoji">📆</div>
                                <div class="diamond-count">Twilight Pass</div>
                                <div class="price-display">Rp. 169.000</div>
                            </div>
                        </div>
                    </div>

                    <div id="weekly-pass-content" class="tab-content hidden">
                        <div class="info-card mb-4">
                            <h4>Weekly Diamond Pass</h4>
                            <p>1. Pastikan untuk membeli Pass setelah LV 5 tercapai.<br>2. Anda tidak dapat membeli Weekly Diamond Pass tambahan.</p>
                            <span class="learn-more">Learn more</span>
                        </div>
                        <div class="diamond-grid">
                            <div class="diamond-item" data-price="33081" data-diamonds="Weekly Diamond Pass">
                                <div class="icon-emoji">📆</div>
                                <div class="diamond-count">Weekly Diamond Pass</div>
                                <div class="price-display">Rp. 33.081</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">3</span>
                        <span class="section-title">Pilih pembayaran</span>
                    </div>

                    <div class="payment-grid">
                        <div class="payment-item disabled-payment">
                            <img src="https://placehold.co/90x50/00a651/ffffff?text=GoPay" alt="Logo GoPay">
                            <div class="payment-name">GoPay</div>
                            <div class="maintenance-overlay">Sedang Perbaikan</div>
                        </div>
                        <div class="payment-item" data-method="DANA">
                            <img src="https://placehold.co/90x50/108ee9/ffffff?text=DANA" alt="Logo DANA">
                            <div class="payment-name">DANA</div>
                        </div>
                        <div class="payment-item disabled-payment">
                            <img src="https://placehold.co/90x50/005691/ffffff?text=QRIS" alt="Logo QRIS">
                            <div class="payment-name">QRIS</div>
                            <div class="maintenance-overlay">Sedang Perbaikan</div>
                        </div>
                        <div class="payment-item disabled-payment">
                            <img src="https://placehold.co/90x50/4c2f9e/ffffff?text=OVO" alt="Logo OVO">
                            <div class="payment-name">OVO</div>
                            <div class="maintenance-overlay">Sedang Perbaikan</div>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">4</span>
                        <span class="section-title">Masukkan Detail</span>
                    </div>
                    <div class="input-group">
                        <input type="email" id="mlbbEmail" placeholder="Masukkan Email Anda">
                    </div>
                </div>

                <div class="fixed-bottom-bar">
                    <button id="mlbbTopupNowBtn" class="confirm-button">
                        Topup Sekarang
                    </button>
                </div>
            </div>
        </div>

        <div id="ffContent" class="content-section">
            <div class="main-content-padding">
                <div class="flex items-center gap-4 mb-5">
                    <div class="icon-emoji w-16 h-16 rounded-lg">🎮</div>
                    <div>
                        <h2 class="text-xl font-bold text-white">Free Fire Top-up</h2>
                        <div class="flex items-center text-sm text-gray-400 mt-1">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 mr-1">
                                <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
                            </svg>
                            Pembayaran yang Aman
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">1</span>
                        <span class="section-title">Masukkan Player ID</span>
                    </div>
                    <div class="input-group">
                        <div class="input-item-row">
                            <input type="text" id="ffPlayerID" placeholder="Masukkan Player ID" pattern="[0-9]*" inputmode="numeric" onpaste="return true;">
                            <div class="info-icon" data-info="Untuk menemukan ID Anda, klik pada ikon karakter. User ID tercantum di bawah nama karakter Anda. Contoh: 5363268446.">?</div>
                        </div>
                        <div id="ffPlayerNameDisplay" class="player-name-display hidden"></div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">2</span>
                        <span class="section-title">Pilih Nominal Top Up</span>
                    </div>
                    <div class="flex items-center text-sm text-red-400 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4 mr-1">
                            <path fill-rule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z" clip-rule="evenodd" />
                        </svg>
                        13.756 item dibeli dalam satu jam terakhir
                    </div>

                    <div class="diamond-grid">
                        <div class="diamond-item" data-price="4080" data-diamonds="5">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">5 Diamonds</div>
                            <div class="price-display">Rp. 4.080</div>
                        </div>
                        <div class="diamond-item popular-item" data-price="6189" data-diamonds="12">
                            <span class="popular-tag">POPULAR</span>
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">12 Diamonds</div>
                            <div class="price-display">Rp. 6.189</div>
                        </div>
                        <div class="diamond-item" data-price="12654" data-diamonds="50">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">50 Diamonds</div>
                            <div class="price-display">Rp. 12.654</div>
                            </div>
                        <div class="diamond-item" data-price="15154" data-diamonds="70">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">70 Diamonds</div>
                            <div class="price-display">Rp. 15.154</div>
                        </div>
                        <div class="diamond-item" data-price="26754" data-diamonds="140">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">140 Diamonds</div>
                            <div class="price-display">Rp. 26.754</div>
                        </div>
                        <div class="diamond-item" data-price="51007" data-diamonds="355">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">355 Diamonds</div>
                            <div class="price-display">Rp. 51.007</div>
                        </div>
                        <div class="diamond-item" data-price="102400" data-diamonds="720">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">720 Diamonds</div>
                            <div class="price-display">Rp. 102.400</div>
                        </div>
                        <div class="diamond-item" data-price="202300" data-diamonds="1450">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">1450 Diamonds</div>
                            <div class="price-display">Rp. 202.300</div>
                        </div>
                        <div class="diamond-item" data-price="302200" data-diamonds="2180">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">2180 Diamonds</div>
                            <div class="price-display">Rp. 302.200</div>
                        </div>
                        <div class="diamond-item" data-price="502000" data-diamonds="3640">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">3640 Diamonds</div>
                            <div class="price-display">Rp. 502.000</div>
                        </div>
                        <div class="diamond-item" data-price="1001500" data-diamonds="7290">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">7290 Diamonds</div>
                            <div class="price-display">Rp. 1.001.500</div>
                        </div>
                        <div class="diamond-item" data-price="4997500" data-diamonds="36500">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">36500 Diamonds</div>
                            <div class="price-display">Rp. 4.997.500</div>
                        </div>
                        <div class="diamond-item" data-price="9992500" data-diamonds="73100">
                            <div class="icon-emoji">💎</div>
                            <div class="diamond-count">73100 Diamonds</div>
                            <div class="price-display">Rp. 9.992.500</div>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">3</span>
                        <span class="section-title">Pilih pembayaran</span>
                    </div>

                    <div class="payment-grid">
                        <div class="payment-item disabled-payment">
                            <img src="https://placehold.co/90x50/00a651/ffffff?text=GoPay" alt="Logo GoPay">
                            <div class="payment-name">GoPay</div>
                            <div class="maintenance-overlay">Sedang Perbaikan</div>
                        </div>
                        <div class="payment-item" data-method="DANA">
                            <img src="https://placehold.co/90x50/108ee9/ffffff?text=DANA" alt="Logo DANA">
                            <div class="payment-name">DANA</div>
                        </div>
                        <div class="payment-item disabled-payment">
                            <img src="https://placehold.co/90x50/005691/ffffff?text=QRIS" alt="Logo QRIS">
                            <div class="payment-name">QRIS</div>
                            <div class="maintenance-overlay">Sedang Perbaikan</div>
                        </div>
                        <div class="payment-item disabled-payment">
                            <img src="https://placehold.co/90x50/4c2f9e/ffffff?text=OVO" alt="Logo OVO">
                            <div class="payment-name">OVO</div>
                            <div class="maintenance-overlay">Sedang Perbaikan</div>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center gap-2 mb-3">
                        <span class="bg-violet-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold">4</span>
                        <span class="section-title">Masukkan Detail</span>
                    </div>
                    <div class="input-group">
                        <input type="email" id="ffEmail" placeholder="Masukkan Email Anda">
                    </div>
                </div>

                <div class="fixed-bottom-bar">
                    <button id="ffTopupNowBtn" class="confirm-button">
                        Topup Sekarang
                    </button>
                </div>
            </div>
        </div>

        <div id="adminLoginScreen" class="admin-screen">
            <div class="admin-login-form">
                <h2 class="text-2xl font-bold text-white mb-4">Login Admin</h2>
                <input type="password" id="adminCodeInput" placeholder="Masukkan Kode Admin">
                <button id="adminLoginSubmitBtn">Login</button>
                <p id="adminLoginError" class="text-red-400 text-sm hidden">Kode admin salah!</p>
            </div>
        </div>

        <div id="adminDashboardScreen" class="admin-screen">
            <div class="admin-dashboard-content">
                <h2 class="text-2xl font-bold text-white mb-4">Dashboard Admin</h2>
                <div id="pendingRequestsList">
                    <p class="text-gray-400 text-center" id="noPendingRequests">Tidak ada permintaan verifikasi tertunda.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="customAlert" class="order-summary-modal">
        <div class="order-summary-content">
            <div class="order-summary-header">
                <h3 id="alertTitle">Info</h3>
                <button class="close-btn" id="closeCustomAlertBtn">×</button>
            </div>
            <p id="alertMessage" class="text-white text-center mb-4"></p>
            <button class="confirm-button" id="okCustomAlertBtn">OK</button>
        </div>
    </div>

    <div id="loadingOverlay" style="display: none;">
        <div class="spinner"></div>
        <p>Memuat...</p>
        <p class="text-sm text-gray-300">Mohon tunggu sebentar, proses sedang berlangsung...</p>
    </div>

    <audio id="notificationSound" src="https://www.soundjay.com/buttons/beep-07a.mp3" preload="auto"></audio>

    <div id="adminNotificationPopup">
        Ada Pesanan Baru!
    </div>

    <script type="module">
        // Impor Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, collection, query, where, getDocs, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Konfigurasi Firebase (Disediakan secara eksplisit oleh pengguna)
        const firebaseConfig = {
            apiKey: "AIzaSyCVoMytk0Xhqcmw8nQNXR6_lb0jLDXp-rY",
            authDomain: "mistry4ever-store-ce987.firebaseapp.com",
            projectId: "mistry4ever-store-ce987",
            storageBucket: "mistry4ever-store-ce987.firebase-storage.app",
            messagingSenderId: "52996287526",
            appId: "1:52996287526:web:1a122e9afce5f5abddcae7",
            measurementId: "G-N0VGECPQB8"
        };
        // Gunakan appId langsung dari konfigurasi yang di-hardcode
        const appId = firebaseConfig.appId;

        // Inisialisasi Firebase
        let app;
        let db;
        let auth;
        let userId = null;
        let isAuthReady = false;
        let isAdminLoggedIn = false;
        let isViewingAdminDashboard = false;
        let unsubscribeAdminRequests = null;
        let adminNotificationListenerSetup = false;

        // Dapatkan elemen suara notifikasi
        const notificationSound = document.getElementById('notificationSound');
        const adminNotificationPopup = document.getElementById('adminNotificationPopup');

        // Fungsi untuk menampilkan overlay loading
        function showLoading(message = "Memuat...") {
            document.getElementById('loadingOverlay').style.display = 'flex';
            document.querySelector('#loadingOverlay p:first-of-type').textContent = message;
            document.querySelector('#loadingOverlay p:last-of-type').textContent = "Mohon tunggu sebentar, proses sedang berlangsung...";
        }

        // Fungsi untuk menyembunyikan overlay loading
        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        // Fungsi untuk memutar suara notifikasi
        function playNotificationSound() {
            if (notificationSound) {
                notificationSound.play().catch(e => console.warn("Error playing sound:", e));
            }
        }

        // Fungsi untuk menampilkan pop-up notifikasi admin
        function showAdminNotificationPopup(message = "Ada Pesanan Baru!") {
            if (adminNotificationPopup) {
                adminNotificationPopup.textContent = message;
                adminNotificationPopup.classList.add('show');
                setTimeout(() => {
                    adminNotificationPopup.classList.remove('show');
                }, 3000); // Sembunyikan setelah 3 detik
            }
        }

        // Inisialisasi Firebase dan autentikasi
        async function initializeFirebase() {
            showLoading("Menginisialisasi Firebase dan autentikasi...");
            try {
                // Inisialisasi aplikasi Firebase dengan konfigurasi yang disediakan secara eksplisit
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // Mengamati perubahan status autentikasi
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("Authenticated with Firebase UID:", userId);
                    } else {
                        // Masuk secara anonim jika tidak ada pengguna yang ditemukan
                        try {
                            const anonymousUser = await signInAnonymously(auth);
                            userId = anonymousUser.user.uid;
                            console.log("Signed in anonymously with Firebase UID:", userId);
                        } catch (error) {
                            console.error("Error signing in anonymously:", error);
                            showCustomAlert("Error Autentikasi", "Gagal melakukan autentikasi anonim: " + error.message);
                        }
                    }
                    isAuthReady = true;
                    hideLoading(); // Sembunyikan loading setelah status autentikasi ditentukan
                    setupAdminNotificationListener(); // Atur listener notifikasi admin setelah auth siap
                });

                // Coba masuk dengan token kustom jika tersedia (untuk lingkungan Canvas)
                // Ini penting untuk menjaga kompatibilitas dengan cara Canvas mengelola autentikasi.
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                }
            } catch (error) {
                console.error("Error initializing Firebase:", error);
                showCustomAlert("Error Inisialisasi", "Gagal menginisialisasi Firebase: " + error.message + ". Fitur database mungkin tidak berfungsi.");
                isAuthReady = true;
                hideLoading(); // Sembunyikan loading saat terjadi error
            }
        }

        // --- DOMContentLoaded memastikan semua elemen HTML tersedia sebelum skrip berjalan ---
        document.addEventListener('DOMContentLoaded', () => {
            initializeFirebase(); // Ini memulai proses loading

            // Fungsi peringatan kustom
            function showCustomAlert(title, message) {
                document.getElementById('alertTitle').textContent = title;
                document.getElementById('alertMessage').innerHTML = message; // Gunakan innerHTML untuk memungkinkan div animasi silang
                document.getElementById('customAlert').classList.add('show');
            }

            function closeCustomAlert() {
                document.getElementById('customAlert').classList.remove('show');
                // Hapus konten dinamis seperti animasi silang
                const crossElement = document.querySelector('.cross-animation');
                if (crossElement) crossElement.remove();
            }

            let selectedGame = '';
            let selectedDiamondPrice = 0;
            let selectedDiamondCount = '';
            let selectedDiamondType = '';
            let selectedPaymentMethod = '';

            const gameSelectionScreen = document.getElementById('gameSelectionScreen');
            const mlbbContent = document.getElementById('mlbbContent');
            const ffContent = document.getElementById('ffContent');
            const adminLoginScreen = document.getElementById('adminLoginScreen');
            const adminDashboardScreen = document.getElementById('adminDashboardScreen');
            const backButton = document.getElementById('backButton'); // Tombol kembali terpadu
            const adminLoginBtn = document.getElementById('adminLoginBtn'); // Ikon admin di header
            const adminCodeInput = document.getElementById('adminCodeInput');
            const adminLoginSubmitBtn = document.getElementById('adminLoginSubmitBtn');
            const adminLoginError = document.getElementById('adminLoginError');
            const pendingRequestsList = document.getElementById('pendingRequestsList');
            const noPendingRequestsMessage = document.getElementById('noPendingRequests');
            const notificationBadge = document.getElementById('notificationBadge');

            // Dapatkan elemen untuk event listener
            const closeCustomAlertBtn = document.getElementById('closeCustomAlertBtn');
            const okCustomAlertBtn = document.getElementById('okCustomAlertBtn');
            const infoIcons = document.querySelectorAll('.info-icon'); // Pilih semua ikon info

            // Status awal: tampilkan layar pemilihan game dan sembunyikan yang lain
            gameSelectionScreen.classList.add('active');
            mlbbContent.classList.remove('active');
            ffContent.classList.remove('active');
            adminLoginScreen.classList.remove('active');
            adminDashboardScreen.classList.remove('active');
            backButton.classList.add('hidden'); // Sembunyikan tombol kembali di awal

            // Fungsi untuk menampilkan layar tertentu
            function showScreen(screenId) {
                document.querySelectorAll('.container > div').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');

                // Kelola visibilitas tombol kembali
                if (screenId === 'gameSelectionScreen') {
                    backButton.classList.add('hidden');
                } else {
                    backButton.classList.remove('hidden');
                }

                // Kelola listener dashboard admin
                if (screenId === 'adminDashboardScreen') {
                    isViewingAdminDashboard = true;
                    notificationBadge.textContent = '0'; // Hapus lencana saat admin melihat dashboard
                    notificationBadge.classList.add('hidden'); // Sembunyikan lencana
                    startAdminDashboardListener();
                } else {
                    isViewingAdminDashboard = false;
                    if (unsubscribeAdminRequests) {
                        unsubscribeAdminRequests(); // Berhenti mendengarkan jika tidak di dashboard admin
                        unsubscribeAdminRequests = null;
                    }
                }
            }

            // Logika tombol kembali terpadu
            backButton.addEventListener('click', () => {
                if (adminDashboardScreen.classList.contains('active')) {
                    // Jika saat ini di dashboard admin, kembali ke login admin
                    showScreen('adminLoginScreen');
                } else if (adminLoginScreen.classList.contains('active')) {
                    // Jika saat ini di login admin, kembali ke pemilihan game
                    showScreen('gameSelectionScreen');
                } else {
                    // Jika di layar konten game, kembali ke pemilihan game
                    goBackToGameSelection();
                }
            });


            // Fungsi untuk kembali ke pemilihan game
            function goBackToGameSelection() {
                showScreen('gameSelectionScreen');

                // Reset pilihan
                selectedGame = '';
                selectedDiamondPrice = 0;
                selectedDiamondCount = '';
                selectedDiamondType = '';
                selectedPaymentMethod = '';

                // Hapus input
                document.getElementById('mlbbUserID').value = '';
                document.getElementById('mlbbZoneID').value = '';
                document.getElementById('mlbbEmail').value = '';
                document.getElementById('ffPlayerID').value = '';
                document.getElementById('ffEmail').value = '';

                // Sembunyikan tampilan nama pemain
                document.getElementById('mlbbPlayerNameDisplay').classList.add('hidden');
                document.getElementById('ffPlayerNameDisplay').classList.add('hidden');


                // Batalkan pilihan semua item diamond
                document.querySelectorAll('.diamond-item').forEach(item => item.classList.remove('selected'));
                // Batalkan pilihan semua item pembayaran
                document.querySelectorAll('.payment-item').forEach(item => item.classList.remove('selected'));
            }

            // Tambahkan event listener untuk tombol peringatan kustom
            closeCustomAlertBtn.addEventListener('click', closeCustomAlert);
            okCustomAlertBtn.addEventListener('click', closeCustomAlert);

            // Tambahkan event listener untuk ikon info (sekarang mereka memicu customAlert)
            infoIcons.forEach(icon => {
                icon.addEventListener('click', function() {
                    const infoMessage = this.getAttribute('data-info');
                    showCustomAlert("Info", infoMessage); // Gunakan peringatan kustom untuk info
                });
            });

            // Fungsi untuk memeriksa dan menonaktifkan item Bonus Isi Ulang 2x yang sudah dibeli
            async function check2xRechargePurchases() {
                if (!isAuthReady || !userId || !db) {
                    console.log("Firebase tidak siap atau userId tidak tersedia untuk pemeriksaan pembelian.");
                    return;
                }

                try {
                    const bonusesRef = collection(db, 'artifacts', appId, 'users', userId, 'rechargeBonuses');
                    const q = query(bonusesRef);
                    const querySnapshot = await getDocs(q);
                    const purchasedBonuses = new Set();
                    querySnapshot.forEach((doc) => {
                        purchasedBonuses.add(doc.id);
                    });

                    const rechargeContent = document.getElementById('2x-recharge-content');
                    if (rechargeContent) {
                        rechargeContent.querySelectorAll('.diamond-item').forEach(item => {
                            const bonusType = item.getAttribute('data-bonus-type');
                            const purchasedOverlay = item.querySelector('.purchased-overlay');
                            const hotTag = item.querySelector('.hot-tag');
                            const topupFirstText = item.querySelector('.topup-first-text');

                            if (bonusType && purchasedBonuses.has(bonusType)) {
                                item.classList.add('purchased-item');
                                if (hotTag) hotTag.classList.add('hidden');
                                if (topupFirstText) topupFirstText.classList.add('hidden');
                                if (purchasedOverlay) purchasedOverlay.classList.remove('hidden');
                            } else {
                                item.classList.remove('purchased-item');
                                if (hotTag) hotTag.classList.remove('hidden');
                                if (topupFirstText) topupFirstText.classList.remove('hidden');
                                if (purchasedOverlay) purchasedOverlay.classList.add('hidden');
                            }
                        });
                    } else {
                        console.warn("#2x-recharge-content tidak ditemukan saat memeriksa pembelian. Ini mungkin normal jika tab tidak aktif.");
                    }
                } catch (error) {
                    console.error("Error checking 2x recharge purchases:", error);
                    showCustomAlert("Error Pembelian Bonus", "Gagal memuat status pembelian bonus: " + error.message);
                }
            }


            // Logika pemilihan game
            document.querySelectorAll('.game-card').forEach(card => {
                card.addEventListener('click', function() {
                    selectedGame = this.getAttribute('data-game');
                    showScreen(selectedGame + 'Content');

                    // Reset tab ke Diamond untuk MLBB
                    if (selectedGame === 'mlbb') {
                        document.querySelectorAll('#mlbbContent .tab-button').forEach(btn => btn.classList.remove('active'));
                        document.querySelector('#mlbbContent .tab-button[data-tab="diamond"]').classList.add('active');
                        document.querySelectorAll('#mlbbContent .tab-content').forEach(content => content.classList.add('hidden'));
                        document.getElementById('diamond-content').classList.remove('hidden');

                        if (isAuthReady) {
                            check2xRechargePurchases();
                        }
                    }

                    // Batalkan pilihan item diamond yang sebelumnya dipilih saat beralih game
                    document.querySelectorAll('.diamond-item').forEach(item => item.classList.remove('selected'));
                    selectedDiamondPrice = 0;
                    selectedDiamondCount = '';
                    selectedDiamondType = '';
                    selectedPaymentMethod = ''; // Reset metode pembayaran saat beralih game
                });
            });

            // --- Logika Pengalihan Tab (khusus MLBB) ---
            document.querySelectorAll('#mlbbContent .tab-button').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('#mlbbContent .tab-button').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    document.querySelectorAll('#mlbbContent .tab-content').forEach(content => content.classList.add('hidden'));
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId + '-content').classList.remove('hidden');
                    // Reset pemilihan diamond saat tab berubah
                    document.querySelectorAll('.diamond-item').forEach(item => item.classList.remove('selected'));
                    selectedDiamondPrice = 0;
                    selectedDiamondCount = '';
                    selectedDiamondType = '';
                });
            });

            // --- Logika Pemilihan Item Diamond ---
            document.querySelectorAll('.diamond-item').forEach(item => {
                item.addEventListener('click', function() {
                    // Cegah pemilihan jika item sudah dibeli
                    if (this.classList.contains('purchased-item')) {
                        showCustomAlert("Info", "Item bonus ini sudah Anda beli. Anda tidak dapat membelinya lagi.");
                        return;
                    }

                    // Hapus kelas 'selected' dari semua item diamond di bagian konten aktif saat ini
                    document.querySelectorAll(`#${selectedGame}Content .diamond-item`).forEach(di => {
                        di.classList.remove('selected');
                    });
                    // Tambahkan kelas 'selected' ke item yang diklik
                    this.classList.add('selected');

                    // Perbarui detail diamond yang dipilih
                    selectedDiamondPrice = parseFloat(this.getAttribute('data-price'));
                    selectedDiamondCount = this.getAttribute('data-diamonds');

                    // Tentukan jenis berdasarkan atribut data-diamonds
                    const bonusTypeAttr = this.getAttribute('data-bonus-type');
                    if (bonusTypeAttr) {
                        selectedDiamondType = `2x Recharge Bonus (${selectedDiamondCount})`;
                    } else if (selectedDiamondCount === 'Twilight Pass') {
                        selectedDiamondType = 'Twilight Pass';
                    } else if (selectedDiamondCount === 'Weekly Diamond Pass') {
                        selectedDiamondType = 'Weekly Diamond Pass';
                    } else {
                        selectedDiamondType = selectedDiamondCount + ' Diamonds';
                    }

                    console.log(`Selected: ${selectedDiamondType} - Rp. ${selectedDiamondPrice}`);
                });
            });

            // --- Logika Pemilihan Metode Pembayaran ---
            document.querySelectorAll('.payment-item').forEach(item => {
                item.addEventListener('click', function() {
                    // Periksa apakah item dinonaktifkan
                    if (this.classList.contains('disabled-payment')) {
                        showCustomAlert("Info", "Metode pembayaran ini sedang dalam perbaikan. Mohon pilih metode lain.");
                        return; // Cegah pemilihan jika dinonaktifkan
                    }

                    // Hapus kelas 'selected' dari semua item pembayaran
                    document.querySelectorAll('.payment-item').forEach(pi => pi.classList.remove('selected'));
                    // Tambahkan kelas 'selected' ke item yang diklik
                    this.classList.add('selected');

                    // Perbarui metode pembayaran yang dipilih
                    selectedPaymentMethod = this.getAttribute('data-method');
                    console.log(`Selected Payment Method: ${selectedPaymentMethod}`);
                });
            });

            // --- Logika Tombol Topup Sekarang ---
            document.getElementById('mlbbTopupNowBtn').addEventListener('click', function() {
                handleTopup('mlbb');
            });

            document.getElementById('ffTopupNowBtn').addEventListener('click', function() {
                handleTopup('ff');
            });

            async function handleTopup(game) {
                let userIDInput, zoneIDInput, emailInput;
                let userID, zoneID, email;
                let playerNameDisplayElement;

                // Debugging: Log status awal
                console.log("handleTopup dipanggil untuk game:", game);

                if (game === 'mlbb') {
                    userIDInput = document.getElementById('mlbbUserID');
                    zoneIDInput = document.getElementById('mlbbZoneID');
                    emailInput = document.getElementById('mlbbEmail');
                    playerNameDisplayElement = document.getElementById('mlbbPlayerNameDisplay');

                    userID = userIDInput.value.trim();
                    zoneID = zoneIDInput.value.trim();
                    email = emailInput.value.trim();

                    // Validasi untuk ID MLBB
                    if (!userID || !/^\d+$/.test(userID)) {
                        showCustomAlert("Info", "User ID Mobile Legends harus berupa angka.");
                        return;
                    }
                    if (!zoneID || !/^\d+$/.test(zoneID)) {
                        showCustomAlert("Info", "Zone ID Mobile Legends harus berupa angka.");
                        return;
                    }
                    if (!email) {
                        showCustomAlert("Info", "Mohon lengkapi Email Anda.");
                        return;
                    }

                } else if (game === 'ff') {
                    userIDInput = document.getElementById('ffPlayerID');
                    emailInput = document.getElementById('ffEmail');
                    playerNameDisplayElement = document.getElementById('ffPlayerNameDisplay');

                    userID = userIDInput.value.trim();
                    email = emailInput.value.trim();
                    zoneID = ''; // FF tidak memiliki Zone ID

                    // Validasi untuk ID FF
                    if (!userID || !/^\d+$/.test(userID)) {
                        showCustomAlert("Info", "Player ID Free Fire harus berupa angka.");
                        return;
                    }
                    if (!email) {
                        showCustomAlert("Info", "Mohon lengkapi Email Anda.");
                        return;
                    }
                }

                // Debugging: Log input yang dikumpulkan
                console.log("User ID:", userID, "Zone ID:", zoneID, "Email:", email);

                if (selectedDiamondPrice === 0) {
                    showCustomAlert("Info", "Mohon pilih nominal top up Diamond terlebih dahulu.");
                    return;
                }
                console.log("Selected Diamond Price:", selectedDiamondPrice);

                if (!selectedPaymentMethod) {
                    showCustomAlert("Info", "Mohon pilih metode pembayaran terlebih dahulu.");
                    return;
                }
                console.log("Selected Payment Method:", selectedPaymentMethod);

                // Periksa apakah itu Bonus Isi Ulang 2x dan apakah sudah dibeli
                const selectedItemElement = document.querySelector(`#${selectedGame}Content .diamond-item.selected`);
                const bonusType = selectedItemElement ? selectedItemElement.getAttribute('data-bonus-type') : null;

                if (bonusType) {
                    if (!isAuthReady || !userId || !db) {
                        showCustomAlert("Error", "Sistem tidak siap untuk memproses pembelian bonus. Mohon coba lagi.");
                        console.error("Firebase not ready for bonus check. isAuthReady:", isAuthReady, "userId:", userId, "db:", db);
                        return;
                    }
                    showLoading("Memeriksa status bonus...");
                    try {
                        const bonusDocRef = doc(db, 'artifacts', appId, 'users', userId, 'rechargeBonuses', bonusType);
                        const docSnap = await getDoc(bonusDocRef);

                        if (docSnap.exists()) {
                            hideLoading();
                            showCustomAlert("Info", "Item bonus ini sudah Anda beli. Anda tidak dapat membelinya lagi.");
                            return; // Hentikan proses jika sudah dibeli
                        }
                    } catch (error) {
                        hideLoading();
                        console.error("Error checking 2x recharge bonus purchase:", error);
                        showCustomAlert("Error Pembelian Bonus", "Gagal memuat status pembelian bonus: " + error.message);
                        return; // Hentikan jika operasi Firestore gagal
                    }
                }

                // --- Mulai Proses Verifikasi ID ---
                if (!isAuthReady || !userId || !db) {
                    showCustomAlert("Error", "Sistem tidak siap untuk verifikasi ID. Mohon coba lagi.");
                    console.error("Firebase not ready for verification. isAuthReady:", isAuthReady, "userId:", userId, "db:", db);
                    return;
                }

                showLoading("Kami sedang verifikasi ID Anda, mohon tunggu...");

                const requestId = crypto.randomUUID(); // ID unik untuk permintaan verifikasi ini
                const verificationDocRef = doc(db, 'artifacts', appId, 'public', 'data', 'verificationRequests', requestId);

                try {
                    // Simpan permintaan tertunda awal ke Firestore
                    console.log("Mencoba mengatur dokumen verifikasi di Firestore dengan requestId:", requestId);
                    await setDoc(verificationDocRef, {
                        buyerFirebaseUid: userId, // UID Firebase pengguna saat ini
                        game: game,
                        gameId: userID,
                        zoneId: zoneID || 'N/A',
                        email: email,
                        status: 'pending', // Status awal
                        timestamp: new Date().toISOString()
                    });
                    console.log(`Permintaan verifikasi ${requestId} berhasil dikirim ke Firestore.`);

                    // Dengarkan pembaruan pada dokumen spesifik ini
                    const unsubscribeBuyer = onSnapshot(verificationDocRef, (docSnap) => {
                        if (docSnap.exists()) {
                            const data = docSnap.data();
                            console.log(`Dokumen verifikasi ${requestId} diperbarui. Status baru: ${data.status}`);
                            if (data.status === 'registered') {
                                hideLoading();
                                unsubscribeBuyer(); // Berhenti mendengarkan setelah verifikasi
                                const playerName = data.playerName || 'Player'; // Default jika admin tidak mengatur nama
                                showCustomAlert("ID Terkonfirmasi!", `Halo ${playerName}! ID Anda telah berhasil diverifikasi.`);

                                // Tunda pengalihan WhatsApp selama 5 detik
                                setTimeout(() => {
                                    // Tampilkan pesan "Halo (nama)"
                                    if (playerNameDisplayElement) {
                                        playerNameDisplayElement.textContent = `Halo ${playerName}`;
                                        playerNameDisplayElement.classList.remove('hidden');
                                        // Gaya sudah diatur di CSS untuk player-name-display
                                    }

                                    // Lanjutkan dengan tautan WhatsApp (hanya setelah verifikasi berhasil)
                                    const finalPrice = selectedDiamondPrice;
                                    let message = `🎮 Game : ${game === 'mlbb' ? 'Mobile Legends' : 'Free Fire'}\n`;
                                    message += `✉️ Email : ${email}\n`;
                                    message += `📄 ID : ${userID}\n`;
                                    if (game === 'mlbb') {
                                        message += `📋 Server ID : ${zoneID}\n`;
                                    }
                                    message += `💎 Topup : ${selectedDiamondType}\n`;
                                    message += `💲 Harga : Rp. ${finalPrice.toLocaleString('id-ID', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}\n`;
                                    message += `📪 Metode : ${selectedPaymentMethod}`;

                                    const whatsappNumber = '6288218776877';
                                    const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
                                    window.open(whatsappURL, '_blank');

                                    // Catat pembelian Bonus Isi Ulang 2x jika berlaku (setelah verifikasi berhasil)
                                    if (bonusType) {
                                        setDoc(bonusDocRef, {
                                            purchased: true,
                                            timestamp: new Date(),
                                            game: game,
                                            diamonds: selectedDiamondCount,
                                            price: selectedDiamondPrice,
                                            email: email,
                                            userIdGame: userID,
                                            zoneIdGame: zoneID || 'N/A'
                                        }).then(() => {
                                            console.log(`Bonus Isi Ulang 2x '${bonusType}' dicatat untuk pengguna ${userId}`);
                                            check2xRechargePurchases(); // Periksa ulang untuk memperbarui UI
                                        }).catch(error => {
                                            console.error("Error recording 2x recharge bonus purchase:", error);
                                            showCustomAlert("Error Rekam Bonus", "Gagal merekam pembelian bonus: " + error.message);
                                        });
                                    }

                                    // Opsional hapus input dan reset pilihan setelah pesanan berhasil
                                    if (game === 'mlbb') {
                                        document.getElementById('mlbbUserID').value = '';
                                        document.getElementById('mlbbZoneID').value = '';
                                        document.getElementById('mlbbEmail').value = '';
                                    } else if (game === 'ff') {
                                        document.getElementById('ffPlayerID').value = '';
                                        document.getElementById('ffEmail').value = '';
                                    }
                                    document.querySelectorAll('.diamond-item').forEach(item => item.classList.remove('selected'));
                                    document.querySelectorAll('.payment-item').forEach(item => item.classList.remove('selected'));
                                    selectedDiamondPrice = 0;
                                    selectedDiamondCount = '';
                                    selectedDiamondType = '';
                                    selectedPaymentMethod = '';
                                }, 5000); // Penundaan 5 detik

                            } else if (data.status === 'unregistered') {
                                hideLoading();
                                unsubscribeBuyer(); // Berhenti mendengarkan setelah verifikasi
                                showCustomAlert("ID Tidak Terdaftar", `ID yang Anda masukkan (${userID}) tidak terdaftar. Mohon periksa kembali.<div class="cross-animation">✖</div>`);
                                // JANGAN lanjutkan dengan WhatsApp
                            }
                            // Jika status masih 'pending', jangan lakukan apa-apa, tetap loading
                        } else {
                            // Dokumen dihapus oleh admin atau tidak pernah ada
                            hideLoading();
                            unsubscribeBuyer();
                            showCustomAlert("Error Verifikasi", "Verifikasi ID dibatalkan atau tidak ditemukan.");
                        }
                    }, (error) => {
                        console.error("Error listening to verification document:", error);
                        hideLoading();
                        showCustomAlert("Error Verifikasi", "Terjadi kesalahan saat menunggu verifikasi ID: " + error.message);
                        unsubscribeBuyer(); // Pastikan listener dilepas saat terjadi error
                    });

                } catch (error) {
                    hideLoading();
                    console.error("Error sending verification request:", error);
                    // Log detail error khusus Firebase
                    if (error.code) {
                        console.error(`Firebase Error Code: ${error.code}`);
                        console.error(`Firebase Error Message: ${error.message}`);
                    }
                    showCustomAlert("Error Pengiriman Verifikasi", `Gagal mengirim permintaan verifikasi ID. Mohon periksa koneksi internet Anda dan pastikan aturan keamanan Firebase sudah benar. Detail: ${error.message}`);
                } finally {
                    // Pastikan loading disembunyikan bahkan jika terjadi error tak terduga
                    hideLoading();
                }
            }

            // --- Logika Login Admin ---
            adminLoginBtn.addEventListener('click', () => {
                showScreen('adminLoginScreen');
                adminCodeInput.value = ''; // Hapus input saat ditampilkan
                adminLoginError.classList.add('hidden');
            });

            adminLoginSubmitBtn.addEventListener('click', () => {
                const enteredCode = adminCodeInput.value;
                if (enteredCode === 'Maj18') { // Kode admin
                    isAdminLoggedIn = true;
                    adminLoginError.classList.add('hidden');
                    showScreen('adminDashboardScreen');
                } else {
                    adminLoginError.classList.remove('hidden');
                }
            });

            // --- Logika Dashboard Admin ---
            function startAdminDashboardListener() {
                if (!isAuthReady || !db) {
                    console.warn("Firebase tidak siap untuk listener dashboard admin.");
                    return;
                }
                if (unsubscribeAdminRequests) {
                    unsubscribeAdminRequests(); // Hentikan listener sebelumnya jika ada
                }

                const requestsRef = collection(db, 'artifacts', appId, 'public', 'data', 'verificationRequests');
                const q = query(requestsRef, where("status", "==", "pending"));

                unsubscribeAdminRequests = onSnapshot(q, (snapshot) => {
                    const newCount = snapshot.size;
                    pendingRequestsList.innerHTML = ''; // Hapus daftar saat ini
                    let hasPending = false;
                    const displayedRequestKeys = new Set(); // Untuk melacak permintaan unik yang ditampilkan dalam snapshot ini

                    snapshot.forEach((doc) => {
                        const request = { id: doc.id, ...doc.data() };
                        let uniqueKey;

                        if (request.game === 'mlbb') {
                            uniqueKey = `${request.gameId}_${request.zoneId}`;
                        } else if (request.game === 'ff') {
                            uniqueKey = request.gameId;
                        } else {
                            uniqueKey = request.id; // Fallback ke ID dokumen jika jenis game tidak diketahui
                        }

                        // Hanya render jika kunci unik ini belum ditampilkan dalam snapshot ini
                        if (!displayedRequestKeys.has(uniqueKey)) {
                            hasPending = true;
                            renderAdminRequest(request);
                            displayedRequestKeys.add(uniqueKey);
                        }
                    });

                    if (!hasPending) {
                        noPendingRequestsMessage.classList.remove('hidden');
                    } else {
                        noPendingRequestsMessage.classList.add('hidden');
                    }

                    // Perbarui lencana dan picu suara/pop-up hanya jika ada permintaan baru DAN tidak sedang melihat dashboard admin
                    if (initialLoadComplete && newCount > notificationCount && !isViewingAdminDashboard) {
                        playNotificationSound();
                        showAdminNotificationPopup(`Ada ${newCount - notificationCount} Pesanan Baru!`);
                    }
                    updateNotificationBadge(newCount); // Perbarui lencana berdasarkan jumlah tertunda saat ini
                    notificationCount = newCount; // Perbarui jumlah saat ini untuk perbandingan berikutnya
                    initialLoadComplete = true; // Tandai pemuatan awal selesai setelah snapshot pertama
                }, (error) => {
                    console.error("Error listening to pending requests:", error);
                    showCustomAlert("Error Dashboard Admin", "Gagal memuat permintaan verifikasi: " + error.message);
                });
            }

            function renderAdminRequest(request) {
                const requestDiv = document.createElement('div');
                requestDiv.className = 'admin-request-item';
                requestDiv.id = `request-${request.id}`;

                requestDiv.innerHTML = `
                    <p><strong>Game:</strong> ${request.game === 'mlbb' ? 'Mobile Legends' : 'Free Fire'}</p>
                    <p><strong>ID:</strong> ${request.gameId} <button class="copy-btn" data-value="${request.gameId}">📋</button><span class="copy-feedback hidden">Copied!</span></p>
                    ${request.zoneId && request.zoneId !== 'N/A' ? `<p><strong>Zone ID:</strong> ${request.zoneId} <button class="copy-btn" data-value="${request.zoneId}">📋</button><span class="copy-feedback hidden">Copied!</span></p>` : ''}
                    <p><strong>Email Pembeli:</strong> ${request.email}</p>
                    <div class="actions">
                        <button class="register-btn" data-id="${request.id}" data-game="${request.game}">Verifikasi & Isi Nama</button>
                        <div class="player-name-input-group hidden" id="player-name-group-${request.id}">
                            <input type="text" placeholder="Nama Pemain" id="player-name-input-${request.id}">
                            <button class="confirm-name-btn" data-id="${request.id}">Konfirmasi</button>
                        </div>
                        <button class="unregister-btn" data-id="${request.id}">Tandai Tidak Terdaftar</button>
                    </div>
                `;
                pendingRequestsList.appendChild(requestDiv);

                // Tambahkan event listener untuk tombol di dalam item permintaan baru ini
                requestDiv.querySelector('.register-btn').addEventListener('click', function() {
                    const gameType = this.getAttribute('data-game');
                    let codashopURL = '';
                    if (gameType === 'mlbb') {
                        codashopURL = 'https://www.codashop.com/id/mobile-legends';
                    } else if (gameType === 'ff') {
                        codashopURL = 'https://www.codashop.com/id/free-fire';
                    }

                    if (codashopURL) {
                        window.open(codashopURL, '_blank');
                    }
                    requestDiv.querySelector('.player-name-input-group').classList.remove('hidden');
                });

                requestDiv.querySelector('.confirm-name-btn').addEventListener('click', async () => {
                    const playerNameInput = document.getElementById(`player-name-input-${request.id}`);
                    const playerName = playerNameInput.value.trim();
                    if (playerName) {
                        await updateVerificationStatus(request.id, 'registered', playerName);
                    } else {
                        showCustomAlert("Info", "Nama pemain tidak boleh kosong.");
                    }
                });

                requestDiv.querySelector('.unregister-btn').addEventListener('click', async () => {
                    await updateVerificationStatus(request.id, 'unregistered');
                });

                // Tambahkan event listener untuk tombol salin
                requestDiv.querySelectorAll('.copy-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const valueToCopy = this.getAttribute('data-value');
                        const feedbackSpan = this.nextElementSibling; // Span tepat setelah tombol

                        try {
                            // Buat elemen textarea sementara
                            const tempInput = document.createElement('textarea');
                            tempInput.value = valueToCopy;
                            document.body.appendChild(tempInput);
                            tempInput.select();
                            document.execCommand('copy');
                            document.body.removeChild(tempInput);

                            // Tampilkan umpan balik
                            feedbackSpan.classList.add('show');
                            setTimeout(() => {
                                feedbackSpan.classList.remove('show');
                            }, 1500); // Sembunyikan "Disalin!" setelah 1.5 detik
                        } catch (err) {
                            console.error('Failed to copy text: ', err);
                            showCustomAlert("Error", "Gagal menyalin. Mohon salin manual.");
                        }
                    });
                });
            }

            async function updateVerificationStatus(requestId, status, playerName = null) {
                if (!isAuthReady || !db) {
                    showCustomAlert("Error", "Firebase tidak siap untuk memperbarui status.");
                    return;
                }
                showLoading("Memperbarui status verifikasi...");
                try {
                    const verificationDocRef = doc(db, 'artifacts', appId, 'public', 'data', 'verificationRequests', requestId);
                    const updateData = { status: status };
                    if (playerName) {
                        updateData.playerName = playerName;
                    }
                    await setDoc(verificationDocRef, updateData, { merge: true }); // Gunakan merge untuk hanya memperbarui bidang yang ditentukan
                    console.log(`Permintaan ${requestId} diperbarui menjadi ${status}`);
                    // Listener onSnapshot akan secara otomatis menghapus item dari daftar
                } catch (error) {
                    console.error("Error updating verification status:", error);
                    showCustomAlert("Error Update Status", "Gagal memperbarui status verifikasi: " + error.message);
                } finally {
                    hideLoading();
                }
            }

            // --- Logika Notifikasi Admin ---
            let notificationCount = 0;
            let initialLoadComplete = false; // Bendera untuk mencegah pemuatan awal memicu notifikasi

            function updateNotificationBadge(count) {
                notificationBadge.textContent = count;
                if (count > 0) {
                    notificationBadge.classList.remove('hidden');
                } else {
                    notificationBadge.classList.add('hidden');
                }
            }

            function setupAdminNotificationListener() {
                // Pastikan listener hanya diatur sekali
                if (adminNotificationListenerSetup) {
                    return;
                }

                if (!isAuthReady || !db) {
                    console.warn("Firebase tidak siap untuk listener notifikasi admin.");
                    return;
                }

                const requestsRef = collection(db, 'artifacts', appId, 'public', 'data', 'verificationRequests');
                const q = query(requestsRef, where("status", "==", "pending"));

                onSnapshot(q, (snapshot) => {
                    const newCount = snapshot.size;
                    // Hanya tampilkan notifikasi jika ada permintaan baru DAN dashboard admin tidak terbuka
                    if (initialLoadComplete && newCount > notificationCount && !isViewingAdminDashboard) {
                        playNotificationSound();
                        showAdminNotificationPopup(`Ada ${newCount - notificationCount} Pesanan Baru!`);
                    }
                    updateNotificationBadge(newCount);
                    notificationCount = newCount; // Perbarui jumlah saat ini untuk perbandingan berikutnya
                    initialLoadComplete = true; // Tandai pemuatan awal selesai setelah snapshot pertama
                }, (error) => {
                    console.error("Error listening to admin notifications:", error);
                });
                adminNotificationListenerSetup = true; // Setel bendera ke true setelah listener diatur
            }
        });
        /* script.js content ends here */
    </script>
</body>
</html>
